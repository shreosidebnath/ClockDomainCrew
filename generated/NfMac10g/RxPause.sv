// Generated by CIRCT firtool-1.47.0
module RxPause(
  input         clock,
                reset,
                io_rst,
  input  [63:0] io_tdata_i,
  input         io_tvalid_i,
                io_tlast_i,
                io_tuser_i,
                io_cfg_rx_pause_enable,
  input  [7:0]  io_cfg_sub_quanta_count,
  output        io_tuser_o,
                io_rx_pause_active
);

  reg  [2:0]  state;
  reg  [15:0] opcode;
  reg  [15:0] quanta;
  reg  [15:0] pause_count;
  reg  [7:0]  sub_count;
  reg         tuser_o_reg;
  reg         rx_pause_active_reg;
  wire        _GEN = (|pause_count) & io_cfg_rx_pause_enable;
  wire        _GEN_0 = sub_count == io_cfg_sub_quanta_count - 8'h1;
  wire        _GEN_1 = state == 3'h2;
  wire        _GEN_2 = io_tdata_i[47:32] == 16'h8808;
  wire        _GEN_3 = state == 3'h3;
  wire        _GEN_4 = opcode == 16'h1;
  wire        _GEN_5 = state == 3'h4;
  wire        _GEN_6 = io_tvalid_i & io_tlast_i;
  always @(posedge clock) begin
    if (reset) begin
      state <= 3'h0;
      opcode <= 16'h0;
      quanta <= 16'h0;
      pause_count <= 16'h0;
      sub_count <= 8'h0;
      tuser_o_reg <= 1'h0;
      rx_pause_active_reg <= 1'h0;
    end
    else begin
      if (io_rst | (|state) & state != 3'h1 & state != 3'h2 & state != 3'h3
          & state != 3'h4)
        state <= 3'h0;
      else if (|state) begin
        if (_GEN_1) begin
          if (io_tvalid_i)
            state <= {1'h0, _GEN_2, 1'h1};
        end
        else if (_GEN_3) begin
          if (io_tvalid_i) begin
            if (_GEN_4)
              state <= 3'h4;
            else
              state <= 3'h1;
          end
        end
        else if ((_GEN_5 | state == 3'h1) & _GEN_6)
          state <= 3'h0;
      end
      else if (io_tvalid_i) begin
        if (io_tdata_i[47:0] == 48'h180C2000001)
          state <= 3'h2;
        else
          state <= 3'h1;
      end
      if (io_rst) begin
        opcode <= 16'h0;
        quanta <= 16'h0;
        pause_count <= 16'h0;
      end
      else begin
        if ((|state) & _GEN_1 & io_tvalid_i & _GEN_2)
          opcode <= {io_tdata_i[55:48], io_tdata_i[63:56]};
        if (~(|state) | _GEN_1 | ~(_GEN_3 & io_tvalid_i & _GEN_4)) begin
        end
        else
          quanta <= {io_tdata_i[7:0], io_tdata_i[15:8]};
        if (~(|state) | _GEN_1 | _GEN_3 | ~(_GEN_5 & _GEN_6 & io_tuser_i)) begin
          if (_GEN & _GEN_0)
            pause_count <= pause_count - 16'h1;
        end
        else
          pause_count <= quanta;
      end
      if (io_rst | ~_GEN | _GEN_0)
        sub_count <= 8'h0;
      else
        sub_count <= sub_count + 8'h1;
      tuser_o_reg <= io_tuser_i;
      rx_pause_active_reg <= ~io_rst & (|pause_count);
    end
  end // always @(posedge)
  assign io_tuser_o = tuser_o_reg;
  assign io_rx_pause_active = rx_pause_active_reg;
endmodule

